@import views.html.helper.form
@import net.wa9nnn.rc210.ui.Tabs

@import scala.util.Random
@import net.wa9nnn.rc210.data.macros.MacroNode
@import net.wa9nnn.rc210.data.functions.FunctionsProvider
@(macroNode: MacroNode)(implicit functionsProvider: FunctionsProvider)

    @tabbedmain(Tabs.macrosTab) {
        <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
        <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/dualList.css")">

        <script src="@routes.Assets.versioned("javascripts/macroNode.js")"></script>


        @form(action = routes.MacroEditorController.save(), Symbol("id") -> "macroNodeForm") {
            <input type="hidden" name="key", value="@macroNode.key">
            <input type="hidden" name="functionIds" id="functionIds">
            <div class="row">
                <div class="col col-md-auto border border-primary">
                    <h2>@fieldNamedKey(macroNode.key)</h2>
//                    @Html(macroNode.key.keyWithName)
                    <div><label for="dtmf">DTMF: </label>
                        <input id="dtmf" name="dtmf" value="@macroNode.dtmf">
                    </div>

                    @submitButton()
                </div>
                <div class="col col-md-auto border border-primary">
                    <h2>Current</h2>

                        <ul id="currentList" class="border border-primary list-unstyled">
                    @for(functionkey <- macroNode.functions) {
                        <li
                        class="functionSource"
                        data-function="@functionkey.toString"
                        onclick="remove(this)">
                            @functionsProvider.apply(functionkey).get
                        </li>
                    }
                    </ul>
                </div>
                <div class="col col-md-auto ">
                    <h2>Available Functions</h2>
                    <div id="myDropdown" class="dropdown-content show functionList">
                        <input type="text" placeholder="Search.." id="filter" onkeyup="filterFunction()">
                        <div>
                            <ul id="availableList" class="list-unstyled">
                            @for(function <- functionsProvider.functions) {
                                <li class="functionSource"
                                onclick="remove(this)"
                                data-function="@function.key.toString">
                                    @function
                                </li>
                            }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        }
    }