@import net.wa9nnn.rc210.data.meter.{AlarmType, Meter, MeterFaceName}
@import net.wa9nnn.rc210.ui.Tabs
@import net.wa9nnn.rc210.util.MacroSelect
@import views.html.helper.{FieldConstructor, _}
@(metersForm: Form[Meter])(implicit messages: MessagesProvider)
    @implicitField = @{
        FieldConstructor(views.html.rc2input.f)
    }

    @tabbedmain(Tabs.metersTab) {
        <div class="container">
            <div class="row">
                @form(action = routes.MeterEditorController.save()) {
                    <div class="col-    "><table>
                        <tr>
                            <td>Reference Voltage</td>
                            <td> @inputText(metersForm("referenceVoltage"))</td>
                        </tr>
                    </table>
                    </div>
                    <div class="col-"><table class="table table-bordered table-sm  w-auto rc210-table">

                        <thead>
                            <tr class="table-secondary">
                                <th colspan="7">Meter Channels</th>
                            </tr>
                            <tr class="table-secondary">
                                <th rowspan="2">Meter</th>
                                <th rowspan="2">Name</th>
                                <th rowspan="2">Face</th>
                                <th colspan="2">Low Calibration</th>
                                <th colspan="2">High Calibration</th>
                            </tr>
                            <tr class="table-secondary">
                                <th>Hundreths/Volt</th>
                                <th>Reading</th>
                                <th>Hundreths/Volt</th>
                                <th>Reading</th>
                            </tr>
                        </thead>

                        <tbody>
                        @repeatWithIndex(metersForm("meters"), min = 1) { (meter, index) =>
                            <tr>
                                <td>@{
                                    index + 1
                                }</td>
                                <td>@inputText(meter("name"))</td>
                                @* <td>@inputText(meter("name"), Symbol("class") -> "nameField")</td>*@
                                <td>@select(meter("faceName"), MeterFaceName.options)</td>
                                <td>@inputText(meter("low.hundredthVolt"))</td>
                                <td>@inputText(meter("low.reading"))</td>
                                <td>@inputText(meter("high.hundredthVolt"))</td>
                                <td>@inputText(meter("high.reading"))</td>
                            </tr>
                        }

                        </tbody>
                    </table>
                    </div>
                    <div class="col-">
                        <table class="table table-bordered table-sm  w-auto rc210-table">
                            <thead>
                                <tr class="table-secondary">
                                    <th colspan="6">Meter  Alarms</th>
                                </tr>
                                <tr class="table-secondary">
                                    <th>Alarm</th>
                                    <th>Name</th>
                                    <th>Meter</th>
                                    <th>Type</th>
                                    <th>Trip Point</th>
                                    <th>Macro</th>
                                </tr>
                            </thead>
                            <tbody>
                            @repeatWithIndex(metersForm("alarms"), min = 1) { (alarm, index) =>
                                <tr>
                                    <td>@{
                                        index + 1
                                    }</td>
                                    <td>@inputText(alarm("name"))</td>
                                    <td>@select(alarm("meterNumber"), for(n <- 1 to 8) yield {
                                        n.toString -> n.toString
                                    })</td>
                                    <td>@select(alarm("alarmType"), AlarmType.options)</td>
                                    <td>@inputText(alarm("tripPoint")) </td>
                                    <td>@select(alarm("macroKey"), MacroSelect.options)</td>
                                </tr>
                            }

                            </tbody>
                        </table>
                    </div>
                    <input type="submit" class="btn btn-primary" name="save" value="Save">
                </div></div>
    }

    }
